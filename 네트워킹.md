# 네트워킹

- iOS 에서는 URLSession을 통해서 Networking을 한다.

- 컴퓨터 입장에서 네트워킹은 느린 작업이다..

- Concurrency(동시성) : 컴퓨터는 네트워킹이 되는 동안에도 사용자 interaction이 되어 즉각적인 반응을 주어야 한다.

  - ... 동시에 여러개를 수행해야 한다! -> GCD & Operations

  

- 서버와 앱 간에 HTTP라는 방법으로 RESTAPi를 이용해서 JSON 타입의 데이터를 주고 받는다.



- HTTP란
  - HyperText Transfer Protocol
  - 클라이언트와 서버간 어떻게 메세지를 주고 받을까에 대한 규칙(통신 규약)
  - 기본적으로 서버와 클라이언트는 메세지를 주고 받는 형식으로 동작한다.
  - 클라이언트는 URL을 통해서 서버에게 요청하는 메세지를 보냄(Request)
  - 서버는 요청에 대한 응답으로 데이터를 준다(Response)
  - HTTP Request Method
    - POST(Create) : 새로운 데이터를 해당 URL에 생성을 요구할때
    - GET(Read) :  해당 URL에 있는 데이터를 보고 싶을때
    - UPDATE(Update) :  해당 URL에 있는 데이터를 수정하고 싶을때
    - DELETE(Delete) :  해당 URL에 있는 데이터를 삭제하고 싶을때
  - URL : Uniform Resource Locator



- Content-Type
  - 어떤 formate의 데이터가 전달될지 표시해주는 것
  - ex ) text/html, application/json, image/png, video/mpeg



- Concurrency(동시성)
  - 한번에 여러개를 수행!
  - App이 한번에 여러개를 수행해야 한다.
    - 사용자 인터랙션 처리 - 메인 스레드에서
    - 네트워킹
    - 백그라운드에서 파일 다운로드
    - 파일 저장하고 읽기



- GCD(Grand Central Patch)
  - 해야 할 일들을 만들어서 GCD에 넘기면 시스템에서 알아서 thread를 할당해서 수행시켜준다.
  - task를 큐를 이용해서 관리한다.
  - DispatchQueue의 타입
    1.  Main Queue : Main thread에서 작동하는 queue 
    2. Global Queue : QoS
    3. Custom Queue : Dispatch Queue를 직접 생성이 가능하다.

~~~swift
// Main Queue
DispatchQueue.main.async {
  // Do Any UI Update Here
}

// Global Queue
DispatchQueue.global(qos: .background).async {
  // Do Heavy Work Here
}

// Custom Queue
let concurrentQueue = DispatchQueue(label: "concurrent", qos: .background, attributes: .concurrent)
let serialQueue = DispatchQueue(label: "serial", qos: .background)
~~~



- Sync(동기) & Async(비동기)
  - 동기는 앞에 작업이 끝나야지만 다음 일을 시작함
  - 비동기는 앞에 작업이 끝나지 않았음에도 다음 일을 시작함



### URLSession

- URLSessionConfiguration
  - Default : 기본 통신
  - Ephemeral : 쿠키, 캐시같은 것을 저장하지 않는 정책일때(크롬, 사파리등에서 private 모드일때)
  - Background : 앱이 백그라운드에 있을때 컨텐츠를 업로드, 다운로드할때 사용
- URLSessionTask
  - URLSessionDataTask : 데이터를 받는 작업일때, response 데이터를 메모리 상에서 처리(간단한 데이터를 받을때), 앱이 background에 있을때는 지원이 안된다.
  - URLSessionUploadTask : 파일을 업로드할때, 파일을 업로드 할때 조금 더 편한 request body를 제공한다
  - URLSessionDownloadTask : 파일을 다운받아서 디스크에 쓸 때  



